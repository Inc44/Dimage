# Dimage

Downloads all media assets from JSON files generated by [DiscordChatExporter](https://github.com/Tyrrrz/DiscordChatExporter).

## ‚öôÔ∏è Features

- Parses `.json` export files from DiscordChatExporter.
- Downloads guild icons, user avatars, mention avatars, reaction avatars, custom emojis (inline and in reactions), and message attachments.
- Organizes downloaded media into subdirectories named after the source channel or DM.
- Optionally categorizes media into folders (icons, avatars, emojis, channels) using a command-line flag.
- Sets local file modification timestamps to match the original Discord message timestamps.
- Skips duplicate URLs to avoid redundant downloads and improve performance.
- Offers fine-grained control over which asset types to download via command-line flags.
- Supports skipping downloads based on file extensions.
- Includes a mode to set timestamps on existing files without downloading.

## üöÄ Installation Steps

1. **Create a Conda environment**:
	```bash
	conda create --name Dimage python=3.10 -y
	```

2. **Activate the Conda environment**:
	```bash
	conda activate Dimage
	```

3. **Clone the repository**:
	```bash
	git clone https://github.com/Inc44/Dimage.git
	```

4. **Navigate into the project directory**:
	```bash
	cd Dimage
	```

5. **Install dependencies**:
	```bash
	pip install -r requirements.txt
	```

6. **Run the script**:
	```bash
	python -OO main.py --no-guild-icon --no-avatars --no-mentions --no-reactions --no-reactions-emojis --no-inline-emojis --no-attachments --no-dupes --skip svg --timestamp-only --organize
	```

## üìñ Usage Examples

_Don't forget to activate your environment_

### Standard Download
Download all media, skipping duplicates and SVG files. Media will be organized into folders named after each channel.
```bash
python -OO main.py --no-dupes --skip svg
```

### Organized Download
Download all media, skipping duplicates and SVG files. Media will be organized by type (`icons`, `avatars`, `emojis`, `channels`).
```bash
python -OO main.py --no-dupes --skip svg --organize
```

### Update Timestamps Only
Apply original timestamps to already downloaded files. Assumes files are in an organized structure. This will not download any new files.
```bash
python -OO main.py --no-dupes --skip svg --timestamp-only --organize
```
**Disclaimer**: The `--timestamp-only` mode assumes the file structure and naming have not been altered since the initial download. It relies on a processing order that may not be stable if files have been moved, renamed, or deleted. Use this feature with the understanding that it is intended for refreshing timestamps on an unmodified collection of downloaded files.

### Attachments Only
Download only message attachments, skipping all other media types, duplicates, and SVG files.
```bash
python -OO main.py --no-guild-icon --no-avatars --no-mentions --no-reactions --no-reactions-emojis --no-inline-emojis --no-dupes --skip svg
```

_I prefer to skip SVG files, as in 99.99% of cases, they are mainly Discord's standard emojis._

## üé® Command-Line Arguments

| Argument                | Description                                                                                     |
|-------------------------|-------------------------------------------------------------------------------------------------|
| `-i, --input <path>`    | Path to the input directory containing `.json` files. Default: `json`.                          |
| `-o, --output <path>`   | Path to the root output directory for downloads. Default: `downloads`.                          |
| `--no-guild-icon`       | Skip downloading the guild/server icon.                                                         |
| `--no-avatars`          | Skip downloading message author avatars.                                                        |
| `--no-mentions`         | Skip downloading avatars of mentioned users.                                                    |
| `--no-reactions`        | Skip downloading avatars of users who reacted.                                                  |
| `--no-reactions-emojis` | Skip downloading custom emojis used in reactions.                                               |
| `--no-inline-emojis`    | Skip downloading custom emojis used inline in messages.                                         |
| `--no-attachments`      | Skip downloading message attachments.                                                           |
| `--no-dupes`            | Avoid downloading duplicate files.                                                              |
| `--skip <exts>`         | Skip files with specified comma-separated extensions.                                           |
| `--timestamp-only`      | Set timestamps on existing files without downloading.                                           |
| `--organize`            | Organize files into categories: `icons`, `avatars`, `emojis`, and `channels` (for attachments). |

## üìú License

[![MIT](https://img.shields.io/badge/License-MIT-lightgrey.svg)](https://opensource.org/licenses/MIT)

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## ü§ù Support

[![BuyMeACoffee](https://img.shields.io/badge/Buy%20Me%20a%20Coffee-ffdd00?style=for-the-badge&logo=buy-me-a-coffee&logoColor=black)](https://buymeacoffee.com/xamituchido)
[![Ko-Fi](https://img.shields.io/badge/Ko--fi-F16061?style=for-the-badge&logo=ko-fi&logoColor=white)](https://ko-fi.com/inc44)
[![Patreon](https://img.shields.io/badge/Patreon-F96854?style=for-the-badge&logo=patreon&logoColor=white)](https://www.patreon.com/Inc44)